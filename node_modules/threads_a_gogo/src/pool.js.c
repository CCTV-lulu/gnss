
static const char* kPool_js= "\n(function createPool(n){'use strict';var o,tagg,jobsCtr;function load(path,cb){o.pool.forEach(function(v,i,o){v.load(path,cb)});return o;}\nfunction wrap(cb){return function wrapcb(err,result){jobsCtr-=1;if(cb)cb.call(this,err,result);}}\nfunction evalAny(src,cb){jobsCtr+=1;o.pool[rnd(o.pool.length)].eval(src,wrap(cb));return o;}\nfunction evalAll(src,cb,i){i=o.pool.length;while(i--){jobsCtr+=1;o.pool[i].eval(src,wrap(cb));};return o;}\nfunction emitAny(t,args){args=Array.prototype.splice.call(arguments,0);t=o.pool[rnd(o.pool.length)];t.emit.apply(t,args);return o;}\nfunction emitAll(t,args,i){args=Array.prototype.splice.call(arguments,0);i=o.pool.length;while(i--){t=o.pool[i];t.emit.apply(t,args);}\nreturn o;}\nfunction on(event,cb){o.pool.forEach(function(v,i,o){v.on(event,cb)});return o;}\nfunction rnd(n){return Math.floor(n*Math.random())}\nfunction destroy(rudeza,sucb,ctr){ctr=0;function micb(){if(++ctr===o.pool.length)setImmediate(sucb);}\nif(typeof sucb!=='function')sucb=0;o.pool.forEach(function(v,i,o){sucb?v.destroy(rudeza,micb):v.destroy(rudeza)});o.any.eval=o.any.emit=o.all.eval=o.all.emit=o.on=o.load=o.destroy=function err(){throw new Error('This thread pool has been destroyed');};o.pool=[];}\nn=Math.floor(n);if(!(n>0)){throw new Error('.createPool( numOfThreads ): numOfThreads must be a Number > 0');}\ntagg=this;jobsCtr=0;o={load:load,on:on,any:{eval:evalAny,emit:emitAny},all:{eval:evalAll,emit:emitAll},totalThreads:function getTotalThreads(){return o.pool.length},idleThreads:function getIdleThreads(){return o.pool.length},pendingJobs:function getPendingJobs(){return jobsCtr},destroy:destroy,pool:[]};try{while(n--)o.pool[n]=tagg.create();}\ncatch(e){if(o.pool.length){o.pool.length-=1;while(o.pool.length)o.pool.pop().destroy(1);}\nthrow e;}\nreturn o;})\n";
